function faqFeedback(type,faqID){var elms=event.target.children,parent=event.target.parentElement.parentElement.children;console.dir(event.target);var typeCount="ThumbsUp"==type?elms.ThumbsUp.innerHTML:elms.ThumbsDown.innerHTML,count=parseInt(typeCount.substring(1,typeCount.length-1))+1;if(0==faqID)var faqID=parent.faqID.value;"ThumbsUp"==type?(event.target.children.ThumbsUp.innerHTML="("+count+")",incrementCounter("FAQ",faqID,type,count)):($("#NegativeFAQFeedbackModal").modal("show"),$("#NegativeFAQFeedbackModal").on("hidden.bs.modal",function(){$(".faqFeedbackDescription").val(""),$(".mpStatus").text(""),$("#SaveFAQFeedback").unbind("click")}),$("#SaveFAQFeedback").click(function(){if(""==$(".faqFeedbackDescription").val())$(".faqFeedbackDescription").css("border","1px solid firebrick"),$(".mpStatus").css("color","firebrick"),$(".mpStatus").text("Please Enter The Reason For Your Feedback");else{elms.ThumbsDown.innerHTML="("+count+")",incrementCounter("FAQ",faqID,type,count);var itemProperties={},updateList;itemProperties.Title=$(".faqFeedbackDescription").val(),itemProperties.AssociatedFAQ=faqID,itemProperties.FeedbackType="FAQFeedback",createSPListItem(siteURL,"FaqFeedback",itemProperties).then(function(){$("#NegativeFAQFeedbackModal").modal("toggle"),swal("Thank You","Your Comments Have Been Logged",{icon:"success",timer:3e3})}).catch(function(error){console.log("Feedback Update Failed"),console.log(error),swal("There was a problem saving your comments","Please try again",{icon:"error"})})}}))}$(document).ready(function(){var vm=this,id=qs("id"),cat=qs("cat"),allFaqs;if(id>0){var selectedFaq;$("main").css("background","##00827e"),$(".categoryList").hide(),getFaqById(id).then(function(faq){var numViews=faq.data.value[0].NumberOfViews+1;$("#catCrumb").attr("href","faqAnswer.aspx?id=0&cat="+faq.data.value[0].Category),$("#catCrumb").text(faq.data.value[0].Category),$(".faqSelectedQuestion").text(faq.data.value[0].Title),$(".faqSelectedAnswer").html(faq.data.value[0].Answer);var crtDate=moment(faq.data.value[0].Created,"YYYY-MM-DD HH:mm").utc().format("DD-MM-YYYY");$(".faqDetails").html("<div class='feedback' style='font-size:small;padding-bottom:10px'>"+faq.data.value[0].Author.Title+" "+crtDate+"&nbsp;&nbsp<i class='far fa-thumbs-up' onclick=(faqFeedback('ThumbsUp',"+id+"))>&nbsp;&nbsp<span id='ThumbsUp'>("+faq.data.value[0].ThumbsUp+")</span></i>&nbsp;&nbsp;<i class='far fa-thumbs-down' onclick=(faqFeedback('ThumbsDown',"+id+"))>&nbsp;&nbsp<span id='ThumbsDown'>("+faq.data.value[0].ThumbsDown+")</span></i></div>"),incrementCounter("FAQ",faq.data.value[0].ID,"NumberOfViews",numViews)})}else{$(".selectedAnswer").hide(),$("main").css("background","#202020");var vm=this,cat=qs("cat");$("#catCrumb").text(cat),$(".catBanner").text(cat+" Questions");var filter,endPointUrl=siteURL+"_api/Web/Lists/getbytitle('FAQ')/Items?$select=Author/Title,Title,ID,Answer,Category,ThumbsUp,ThumbsDown,NumberOfViews,Created,SortOrder&$expand=Author&$filter=Status eq 'Active'"+("Most Popular"==cat||"Latest"==cat?"":" and Category eq '"+cat+"'");axios.get(endPointUrl).then(response=>{var responses=response.data.value;allFaqs="Latest"==cat?responses.sort(function(a,b){return(b.Created>a.Created)-(b.Created<a.Created)}):responses.sort(function(a,b){return(b.ThumbsUp>a.ThumbsUp)-(b.ThumbsUp<a.ThumbsUp)});for(var summaryLength=270,i=0;i<allFaqs.length;i++){var answer=allFaqs[i].Answer,thisID=allFaqs[i].ID,txtAnswer=$(answer).text(),shMore=txtAnswer.length>270?"...  <span class='expand'>MORE >></span>":"",crtDate=moment(allFaqs[i].Created,"YYYY-MM-DD HH:mm").utc().format("DD-MM-YYYY"),author=allFaqs[i].Author.Title,titleURL="faqAnswer.aspx?id="+thisID+"&cat="+cat,faqTitle=allFaqs[i].Title,numOfViews=allFaqs[i].NumberOfViews,numOfThumbsUp=allFaqs[i].ThumbsUp,numOfThumbDown=allFaqs[i].ThumbsDown,faqSummaryText=$.trim(txtAnswer).substring(0,270).trim(this),faqFullText=allFaqs[i].Answer,dblSpace="&nbsp;&nbsp";$(".FaqsForCat").append('<li class="faqList"><input type="hidden" id="NumberOfViews" value='+numOfViews+'><input type="hidden" id="faqID" value='+thisID+'><a href="'+titleURL+'"><span id="itemTitle">'+faqTitle+'</span></a><input type="hidden" id="NumberOfViews" value="'+numOfViews+"\"><div class='feedback' id='itemDetails'>"+author+" "+crtDate+dblSpace+"<i class='far fa-thumbs-up' onclick=(faqFeedback('ThumbsUp',0))>"+dblSpace+"<span id='ThumbsUp'>("+numOfThumbsUp+")</span></i>"+dblSpace+"<i class='far fa-thumbs-down' onclick=(faqFeedback('ThumbsDown',0))>"+dblSpace+"<span id='ThumbsDown'>("+numOfThumbDown+')</span></i></div><div class="faqSummary">'+faqSummaryText+shMore+'</div><div class="faqFull">'+faqFullText+"</div></li>")}$(".faqSummary").click(function(){console.log("Clicked");var parentListItem=$(event.target.closest(".faqList")),numberOfViews=parentListItem.find("#NumberOfViews"),thisID=parentListItem.find("#faqID").val();$(".faqSummary").show(),$(".faqFull").hide(),parentListItem.find(".faqFull").show(),parentListItem.find(".faqSummary").hide();var currCount=parseInt(numberOfViews.val());numberOfViews=currCount++,incrementCounter("FAQ",thisID,"NumberOfViews",currCount++)}),$(".FaqsForCat").paginate({perPage:5,autoScroll:!1,scope:"li",paginatePosition:["bottom"],containerTag:"nav",paginationTag:"ul",itemTag:"li",linkTag:"a",useHashLocation:!0,onPageClick:function(){}})})}});