const host="https:\\\\"+window.location.hostname,path=cutUrl(window.location.pathname),siteURL=host+path,newsURL=host+"\\sites\\groupnews\\",peopleURL=host+"\\sites\\bgintranet_people\\",intranetNews="./news.aspx";function cutUrl(str){var matched=str.match(/([^\/]*\/){3}/),ret;return(matched?matched[0]:str).replace(/\//g,"\\")}function GenerateThumbnail(p_Url){if(void 0===p_Url)return null;var filename=p_Url.substring(p_Url.lastIndexOf("\\")+1),filePath=p_Url.substring(0,p_Url.lastIndexOf("\\")),fileNameWithoutExtension=filename.substring(0,filename.lastIndexOf(".")),ext=filename.substring(filename.lastIndexOf(".")+1),thumbNail;return filePath+"\\_t\\"+encodeURIComponent(fileNameWithoutExtension).replace(/%2520/g,"%20")+"_"+ext+"."+ext}function GenerateThumbnailFile(path,filename){if("undefined"==typeof p_Url)return null;var fileNameWithoutExtension=filename.substring(0,filename.lastIndexOf(".")),ext=filename.substring(filename.lastIndexOf(".")+1),thumbNail;return path+encodeURIComponent(fileNameWithoutExtension).replace(/%2520/g,"%20")+"_"+ext+"."+ext}function qs(key){key=key.replace(/[*+?^$.\[\]{}()|\\\/]/g,"\\$&");var match=location.search.match(new RegExp("[?&]"+key+"=([^&]+)(&|$)"));return match&&decodeURIComponent(match[1].replace(/\+/g," "))}function replaceSpaces(param){return param.replace(/\s+/g,"-")}function cutUrl(str){var matched=str.match(/([^\/]*\/){3}/),ret;return(matched?matched[0]:str).replace(/\//g,"\\")}function clearFormValidations(fieldsToClear,oddBallFields){for(var x=0;x<fieldsToClear.length;x++)$(fieldsToClear[x]).removeClass("ValidationErrorStyle");for(var x=0;x<oddBallFields.length;x++)$(oddBallFields[x].highlightElement).removeClass("ValidationErrorStyle");$(".mpStatus").html("")}function validateForm(fieldsToValidate,oddBallFields,currentSaveMode){for(var passedValidation=!0,x=0;x<fieldsToValidate.length;x++)""==$(fieldsToValidate[x]).val()?($(fieldsToValidate[x]).addClass("ValidationErrorStyle"),passedValidation=!1):$(fieldsToValidate[x]).removeClass("ValidationErrorStyle");for(var x=0;x<oddBallFields.length;x++){var oddBallValidation;0==(oddBallValidation=""==currentSaveMode?""!=$(oddBallFields[x].validateElement).val():currentSaveMode!=oddBallFields[x].saveMode||""!=$(oddBallFields[x].validateElement).val())?($(oddBallFields[x].highlightElement).addClass("ValidationErrorStyle"),passedValidation=!1):$(oddBallFields[x].highlightElement).removeClass("ValidationErrorStyle")}return 0==passedValidation?($(".mpStatus").css("color","red"),$(".mpStatus").html("Please Complete The Fields Highlighted In Red")):($(".mpStatus").css("color","green"),$(".mpStatus").html("Saving")),passedValidation}function loadingOut(loading){}function generateUniqueID(){return Math.round((new Date).getTime()+100*Math.random())}function resetNewsTicker(){var nFeed=$("#profileNewsTicker").is(":checked"),effect=1==nFeed?"scroll":"typography";store.set("newsfeeds",nFeed);var options={effect:effect,play:nFeed};ticker.update(options)}function imgError(image){return image.onerror="",image.src="assets/images/missingprofile.jpg",!0}function setBBCImageURL(pageURL,element){axios.get("https://bypasscors.herokuapp.com/api/?url="+encodeURIComponent(pageURL)).then(resp=>{var el=document.createElement("html");el.innerHTML=resp.data,document.getElementById(element).src=el.querySelector("meta[property='og:image']").getAttribute("content")})}function jsUcfirst(string){return string.charAt(0).toUpperCase()+string.slice(1)}function getUserRoles(param){var user,profileName=JSON.parse(localStorage.getItem("userDetails")).DisplayName,endPointUrl=siteURL+"/_api/Web/Lists/getbytitle('Permissions')/Items?$select=Roles,UserNAme/Title&$expand=UserNAme&$filter=UserNAme/Title eq '"+encodeURI(profileName)+"'";axios.get(endPointUrl).then(response=>{var returnValue=null,userMatches=response.data.value;Array.isArray(userMatches)&&userMatches.length&&(returnValue=userMatches[0].Roles),param=returnValue})}String.prototype.trimToLength=function(m){return this.length>m?jQuery.trim(this).substring(0,m).split(" ").slice(0,-1).join(" ")+".. READ MORE.":this},String.format=function(){for(var s=arguments[0],i=0;i<arguments.length-1;i++){var reg=new RegExp("\\{"+i+"\\}","gm");s=s.replace(reg,arguments[i+1])}return s},window.fadeIn=function(obj){$(obj).fadeIn(2e3)};